# Описание проекта DependencyResolver


* **Статус**: *proposed*
* **ЛПР**: Зиновьев А.Н., Цыпляшов А.Н., ...
* **Дата**: 2023.10.04

### Описание задачи:
Создать инсструмент для создания списка всех зависимостей проекта
**Задача** https://jiradev.int.gazprombank.ru/jira/browse/URRP-7593

## Контекст и постановка вопроса

Для сокращения количества обращений к ops специалистам и к сотрудникам службы безопсности необходимо 
создать инструмент который мог бы перечислить все необходимые для тестирования и сборки проекта 
зависимости включая указанные в этих зависимостях родительские зависимости и их зависимости.

### Основные ограничения
1. Проекты нельзя вынести из контура безопвсности
2. Занесение артефактов должно происходить централизовано через СБ и Ops-специалистов

## Приоритеты для принятия решения

* Простота использования.
* Полнота результатов работы приложения.
* Скорость разработки.
* Возможность доработки.

## Предлягаемое решение

* Реализовать два проекта
1. **DependencyExplorer** который будет находить зависимости во внешних репозиториях, парсить их 
`pom` файлы, находить их зависимости и родительские проекты и находить их во внешних репозиториях, 
на выходе будет список зависимостей и ссылки на них во внешнмх репозиториях.
2. **NexusExplorer** который будет находить занесенные в nexus во внутреннем контуре зависимости и 
выводить в файл результата список незанесенных зависимостей.

#### Подробности реализации для решения
1. Реализация вне контура безопасности.
2. Поставляться для использования в качестве образов _docker_ (**DependencyExplorer** 
распространяется вне контура, а **NexusExplorer** должен быть загружен в контур безопасности). Для
   **NexusExplorer** должен быть предусмотрен вариант поставки в виде fat jar.
3. В качестве входных и выходных данных используются файлы с определенными именами в заранее 
определенных локациях, которые будут маунтиться к контейнеру.

#### Рабочий процесс получения списка зависимостей для занесения артефактов
1. Отправить на внешний контур:
   1. Версию градла;
   2. Плагины и их версии;
   3. Список зависимостей необходимых для добавления;
   4. Список зависимостей зависимых от необъодимых для добавления зависимостей и от их зависимостей;
   5. Список зависимостей от которых зависят зависимости необходимые для добавления и их зависимости.
        ###### Примечание – Пункты iv и v допускается заменить файлом _build.gradle_ c заменой зависимостей которые есть только внутри контура безопасности на их заивсимости.
2. Создать проект _gradle_ со всеми плагинами и зависимостями, запустить задачу 
`dependencies >> ./deptree.txt`.
3. Скопировать файл _./deptree.txt_ в необходимый каталог и запустить контейнер с 
**DependencyExplorer**, который выведет все зависимости с urlами в сторонних репозиториях, в том 
числе транзитивные и их родителей со своими зависимостями, указанными в _./deptree.txt_.
4. Отправить зависимости во внутренний контур.
5. Запустить во внутреннем контуре **NexusExplorer**, который выдаст список отсутствующих в nexus 
зависимостей.
6. Дальше по существующим процессам.